---
kind: pipeline
name: default

steps:
        - name: unittest
          image: docker:dind
          volumes:
                  - name: dockersock
                    path: /var/run
          commands:
                  - apk add git go
                  - go get github.com/magefile/mage
                  - mage unittest

services:
        - name: docker
          image: docker:dind
          privileged: true
          volumes:
                  - name: dockersock
                    path: /var/run

volumes:
        - name: dockersock
          temp: {}
